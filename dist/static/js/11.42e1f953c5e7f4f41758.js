webpackJsonp([11],{"/t6J":function(t,e,a){"use strict";e.a=function(t){return Object(r.a)({url:"/kong/role/add",method:"post",data:t})},e.e=function(t){return Object(r.a)({url:"/kong/role/info",method:"get",params:t})},e.b=function(t){return Object(r.a)({url:"/kong/role/delete",method:"get",params:t})},e.c=function(t){return Object(r.a)({url:"/kong/role/lists",method:"get",params:t})},e.d=function(t){return Object(r.a)({url:"/kong/role/routers",method:"post",data:t})},e.g=function(t){return Object(r.a)({url:"/kong/role/routers/update",method:"post",data:t})},e.f=function(){return Object(r.a)({url:"/kong/role/reload",method:"get",params:{}})};var r=a("BXx+")},VI2i:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=a("Edqs"),n=a.n(r),o=a("Hmpo"),i=a.n(o),l=a("vYJH"),s=a.n(l),c=a("/t6J"),u=a("T452"),d={name:"role-lists",data:function(){return{list:[],listLoading:!0,page:1,total:0,pagesize:10,searchForm:{size:50},dialogTableVisible:!1,hideDialogPagination:!1,router:{list:[],total:0,form:{size:20,roleId:0,searchText:"",page:1}}}},created:function(){this.fetchData()},methods:{fetchData:function(){var t=this;return s()(i.a.mark(function e(){var a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(c.c)();case 2:(a=e.sent).data.code==u.d&&(t.list=a.data.data.items,t.total=a.data.data.total,t.listLoading=!1);case 4:case"end":return e.stop()}},e,t)}))()},reloadRoutes:function(){var t=this;return s()(i.a.mark(function e(){return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(c.f)();case 2:t.sent;case 4:case"end":return t.stop()}},e,t)}))()},handleCurrentChange:function(t){n()(this.searchForm,{page:t}),this.fetchData()},setRoleId:function(t){this.router.form.roleId=t,this.router.form.searchText="",this.router.form.page=1,this.searchRoleRouter()},searchRoleRouter:function(){var t=this;return s()(i.a.mark(function e(){var a;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=3,Object(c.d)(t.router.form);case 3:(a=e.sent).data.code==u.d&&(t.router.list=a.data.data.items,t.router.total=a.data.data.total,t.listLoading=!1),t.dialogTableVisible=!0;case 7:case"end":return e.stop()}},e,t)}))()},handleDialogRouterPageChange:function(t){this.router.form.page=t,this.searchRoleRouter()},updateRouter:function(t){var e=this;return s()(i.a.mark(function a(){var r;return i.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return r={roleId:e.router.form.roleId,routerId:t},a.next=3,Object(c.g)(r);case 3:a.sent.data.code==u.d&&e.searchRoleRouter();case 5:case"end":return a.stop()}},a,e)}))()},add:function(t){this.$router.push({path:"/user/role/add/"+t})},delRole:function(t){var e=this,a=this,r={id:t};this.$confirm("此操作将永久删除角色, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(c.b)(r).then(function(t){t.data.code==u.d&&(e.$message({type:"success",message:"删除成功!"}),a.fetchData())})})}}},f={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("div",{attrs:{className:"sub-navbar"}},[[a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"success"},on:{click:function(e){t.reloadRoutes()}}},[t._v("刷新权限")]),t._v(" "),a("el-button",{staticStyle:{"margin-left":"10px"},attrs:{type:"primary"},on:{click:function(e){t.add(0)}}},[t._v("新建角色")])]],2),t._v(" "),a("div",{staticClass:"routes-main-container",staticStyle:{"margin-top":"30px"}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading.body",value:t.listLoading,expression:"listLoading",modifiers:{body:!0}}],attrs:{data:t.list,"element-loading-text":"Loading",border:"",fit:"","highlight-current-row":""}},[a("el-table-column",{attrs:{align:"center",label:"ID"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                    "+t._s(e.row.id)+"\n                ")]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"角色名",width:"200",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.role_name))])]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"角色介绍"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.role_desc))])]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",prop:"created_at",label:"创建时间",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("i",{staticClass:"el-icon-time"}),t._v(" "),a("span",[t._v(t._s(e.row.created_at))])]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{size:"mini"},on:{click:function(a){t.add(e.row.id)}}},[t._v("编辑")]),t._v(" "),a("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(a){t.delRole(e.row.id)}}},[t._v("删除")]),t._v(" "),a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){t.setRoleId(e.row.id)}}},[t._v("配置路由")])]}}])})],1),t._v(" "),a("el-row",{staticStyle:{"margin-top":"30px"},attrs:{type:"flex",justify:"center"}},[a("el-pagination",{attrs:{background:"",layout:"prev, pager, next","current-page":t.page,"page-size":t.searchForm.size,total:t.total},on:{"current-change":t.handleCurrentChange}})],1)],1),t._v(" "),a("el-dialog",{attrs:{title:"配置路由",visible:t.dialogTableVisible,"modal-append-to-body":!1},on:{"update:visible":function(e){t.dialogTableVisible=e}}},[a("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{placeholder:"路由名"},model:{value:t.router.form.searchText,callback:function(e){t.$set(t.router.form,"searchText",e)},expression:"router.form.searchText"}}),t._v(" "),a("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.searchRoleRouter}},[t._v("搜索\n        ")]),t._v(" "),a("el-table",{staticStyle:{"margin-top":"10px"},attrs:{data:t.router.list,border:"",fit:"","highlight-current-row":""}},[a("el-table-column",{attrs:{align:"center",label:"ID",width:"90"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                    "+t._s(e.row.id)+"\n                ")]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"路由名",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                    "+t._s(e.row.name)+"\n                ")]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"路由规则"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                    "+t._s(e.row.route)+"\n                ")]}}])}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:"操作",width:"120"},scopedSlots:t._u([{key:"default",fn:function(e){return[1==e.row.bound?a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(a){t.updateRouter(e.row.id)}}},[t._v("解绑路由\n                    ")]):a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(a){t.updateRouter(e.row.id)}}},[t._v("绑定路由\n                    ")])]}}])})],1),t._v(" "),a("div",{staticClass:"pagination-container",attrs:{hidden:t.hideDialogPagination}},[a("el-pagination",{attrs:{background:"",layout:"prev, pager, next","current-page":t.page,"page-size":t.router.form.size,total:t.router.total},on:{"current-change":t.handleDialogRouterPageChange}})],1)],1)],1)},staticRenderFns:[]},p=a("D8HT")(d,f,!1,null,null,null);e.default=p.exports}});
//# sourceMappingURL=11.42e1f953c5e7f4f41758.js.map