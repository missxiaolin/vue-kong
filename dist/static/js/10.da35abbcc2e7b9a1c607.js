webpackJsonp([10],{"/t6J":function(e,t,r){"use strict";t.a=function(e){return Object(a.a)({url:"/kong/role/add",method:"post",data:e})},t.e=function(e){return Object(a.a)({url:"/kong/role/info",method:"get",params:e})},t.b=function(e){return Object(a.a)({url:"/kong/role/delete",method:"get",params:e})},t.c=function(e){return Object(a.a)({url:"/kong/role/lists",method:"get",params:e})},t.d=function(e){return Object(a.a)({url:"/kong/role/routers",method:"post",data:e})},t.g=function(e){return Object(a.a)({url:"/kong/role/routers/update",method:"post",data:e})},t.f=function(){return Object(a.a)({url:"/kong/role/reload",method:"get",params:{}})};var a=r("BXx+")},VI2i:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r("Edqs"),o=r.n(a),n=r("Hmpo"),s=r.n(n),i=r("vYJH"),l=r.n(i),u=r("/t6J"),c=r("vMJZ"),d=r("T452"),f={name:"role-lists",data:function(){return{userPower:{user_role_reload:0,user_role_add:0,user_role_delete:0,user_role_routers_update:0},list:[],listLoading:!0,page:1,total:0,pagesize:10,searchForm:{size:50},dialogTableVisible:!1,hideDialogPagination:!1,router:{list:[],total:0,form:{size:20,roleId:0,searchText:"",page:1}}}},created:function(){this.fetchData()},methods:{fetchData:function(){var e=this;return l()(s.a.mark(function t(){var r,a;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(u.c)();case 2:return(r=t.sent).data.code==d.d&&(e.list=r.data.data.items,e.total=r.data.data.total,e.listLoading=!1),t.next=6,Object(c.a)(e.userPower);case 6:(a=t.sent).data.code==d.d&&(e.userPower=a.data.data);case 8:case"end":return t.stop()}},t,e)}))()},reloadRoutes:function(){var e=this;return l()(s.a.mark(function t(){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(u.f)();case 2:e.sent;case 4:case"end":return e.stop()}},t,e)}))()},handleCurrentChange:function(e){o()(this.searchForm,{page:e}),this.fetchData()},setRoleId:function(e){this.router.form.roleId=e,this.router.form.searchText="",this.router.form.page=1,this.searchRoleRouter()},searchRoleRouter:function(){var e=this;return l()(s.a.mark(function t(){var r;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(u.d)(e.router.form);case 2:(r=t.sent).data.code==d.d&&(e.router.list=r.data.data.items,e.router.total=r.data.data.total,e.listLoading=!1),e.dialogTableVisible=!0;case 5:case"end":return t.stop()}},t,e)}))()},handleDialogRouterPageChange:function(e){this.router.form.page=e,this.searchRoleRouter()},updateRouter:function(e){var t=this;return l()(s.a.mark(function r(){var a;return s.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return a={roleId:t.router.form.roleId,routerId:e},r.next=3,Object(u.g)(a);case 3:r.sent.data.code==d.d&&t.searchRoleRouter();case 5:case"end":return r.stop()}},r,t)}))()},add:function(e){this.$router.push({path:"/user/role/add/"+e})},delRole:function(e){var t=this,r=this,a={id:e};this.$confirm("此操作将永久删除角色, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(u.b)(a).then(function(e){e.data.code==d.d&&(t.$message({type:"success",message:"删除成功!"}),r.fetchData())})})}}},p={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-container"},[r("div",{attrs:{className:"sub-navbar"}},[[r("el-button",{directives:[{name:"show",rawName:"v-show",value:0!=e.userPower.user_role_reload,expression:"userPower.user_role_reload != 0"}],staticStyle:{"margin-left":"10px"},attrs:{type:"success"},on:{click:function(t){e.reloadRoutes()}}},[e._v("刷新权限")]),e._v(" "),r("el-button",{directives:[{name:"show",rawName:"v-show",value:0!=e.userPower.user_role_add,expression:"userPower.user_role_add != 0"}],staticStyle:{"margin-left":"10px"},attrs:{type:"primary"},on:{click:function(t){e.add(0)}}},[e._v("新建角色")])]],2),e._v(" "),r("div",{staticClass:"routes-main-container",staticStyle:{"margin-top":"30px"}},[r("el-table",{directives:[{name:"loading",rawName:"v-loading.body",value:e.listLoading,expression:"listLoading",modifiers:{body:!0}}],attrs:{data:e.list,"element-loading-text":"Loading",border:"",fit:"","highlight-current-row":""}},[r("el-table-column",{attrs:{align:"center",label:"ID"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                    "+e._s(t.row.id)+"\n                ")]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"角色名",width:"200",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.row.role_name))])]}}])}),e._v(" "),r("el-table-column",{attrs:{label:"角色介绍"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("span",[e._v(e._s(t.row.role_desc))])]}}])}),e._v(" "),r("el-table-column",{attrs:{align:"center",prop:"created_at",label:"创建时间",width:"200"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("i",{staticClass:"el-icon-time"}),e._v(" "),r("span",[e._v(e._s(t.row.created_at))])]}}])}),e._v(" "),r("el-table-column",{attrs:{align:"center",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{directives:[{name:"show",rawName:"v-show",value:0!=e.userPower.user_role_add,expression:"userPower.user_role_add != 0"}],attrs:{size:"mini"},on:{click:function(r){e.add(t.row.id)}}},[e._v("编辑")]),e._v(" "),r("el-button",{directives:[{name:"show",rawName:"v-show",value:0!=e.userPower.user_role_delete,expression:"userPower.user_role_delete != 0"}],attrs:{size:"mini",type:"danger"},on:{click:function(r){e.delRole(t.row.id)}}},[e._v("删除")]),e._v(" "),r("el-button",{directives:[{name:"show",rawName:"v-show",value:0!=e.userPower.user_role_routers_update,expression:"userPower.user_role_routers_update != 0"}],attrs:{type:"primary",size:"mini"},on:{click:function(r){e.setRoleId(t.row.id)}}},[e._v("配置路由")])]}}])})],1),e._v(" "),r("el-row",{staticStyle:{"margin-top":"30px"},attrs:{type:"flex",justify:"center"}},[r("el-pagination",{attrs:{background:"",layout:"prev, pager, next","current-page":e.page,"page-size":e.searchForm.size,total:e.total},on:{"current-change":e.handleCurrentChange}})],1)],1),e._v(" "),r("el-dialog",{attrs:{title:"配置路由",visible:e.dialogTableVisible,"modal-append-to-body":!1},on:{"update:visible":function(t){e.dialogTableVisible=t}}},[r("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{placeholder:"路由名"},model:{value:e.router.form.searchText,callback:function(t){e.$set(e.router.form,"searchText",t)},expression:"router.form.searchText"}}),e._v(" "),r("el-button",{staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.searchRoleRouter}},[e._v("搜索\n        ")]),e._v(" "),r("el-table",{staticStyle:{"margin-top":"10px"},attrs:{data:e.router.list,border:"",fit:"","highlight-current-row":""}},[r("el-table-column",{attrs:{align:"center",label:"ID",width:"90"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                    "+e._s(t.row.id)+"\n                ")]}}])}),e._v(" "),r("el-table-column",{attrs:{align:"center",label:"路由名",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                    "+e._s(t.row.name)+"\n                ")]}}])}),e._v(" "),r("el-table-column",{attrs:{align:"center",label:"路由规则"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                    "+e._s(t.row.route)+"\n                ")]}}])}),e._v(" "),r("el-table-column",{attrs:{align:"center",label:"操作",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[1==t.row.bound?r("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(r){e.updateRouter(t.row.id)}}},[e._v("解绑路由\n                    ")]):r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(r){e.updateRouter(t.row.id)}}},[e._v("绑定路由\n                    ")])]}}])})],1),e._v(" "),r("div",{staticClass:"pagination-container",attrs:{hidden:e.hideDialogPagination}},[r("el-pagination",{attrs:{background:"",layout:"prev, pager, next","current-page":e.page,"page-size":e.router.form.size,total:e.router.total},on:{"current-change":e.handleDialogRouterPageChange}})],1)],1)],1)},staticRenderFns:[]},h=r("D8HT")(f,p,!1,null,null,null);t.default=h.exports}});
//# sourceMappingURL=10.da35abbcc2e7b9a1c607.js.map